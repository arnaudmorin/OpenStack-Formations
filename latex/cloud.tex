  \section[Cloud]{Le Cloud : vue d'ensemble}

  \subsection[Cloud]{Le Cloud : les concepts}

  \begin{frame}
    \frametitle{Le cloud, c'est large !}
    \begin{itemize}
      \item Stockage \pause
      \item Calcul \pause
      \item Virtualisation++\pause
      \item Abstraction du matériel\pause
      \item \alert<8->{Accès normalisé par des APIs}\pause
      \item Service et facturation à la demande\pause
      \item \alert<9->{Flexibilité, élasticité}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{WaaS : Whatever as a Service}
    \begin{itemize}
      \item Principalement\pause
      \begin{description}
        \item[IaaS] \alert<5->{Infrastructure as a Service}\pause
        \item[PaaS] Platform as a Service\pause
        \item[SaaS] Software as a Service\pause
      \end{description}
      \pause
      \item Mais aussi :
      \pause
      \begin{itemize}
        \item Database as a Service
        \item Network as a Service
        \item Firewall as a Service
        \item Load balancing as a Service\pause
        \item Whatever as a Service
      \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Cloud public ou cloud privé ?}
    \begin{description}
      \item[Public] fourni par un hébergeur à des clients (AWS, Rackspace Cloud, Azure, etc.)
      \item[Privé] plateforme et ressources internes
      \item[Hybride] utilisation de ressources publiques au sein d'un cloud privé
    \end{description}
  \end{frame}

  \begin{frame}
    \frametitle{Les modèles cloud en un schéma}
    \includegraphics[width=\linewidth,height=\textheight]{images/cloud.png}
  \end{frame}

  \begin{frame}
    \frametitle{Pourquoi du cloud ? Côté business}
    \begin{itemize}
      \item Baisse des coûts par la mutualisation des ressources
      \item Utilisation uniquement des ressources qui sont nécessaires
      \item À grande échelle, garantie de service
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Pourquoi du cloud ? Côté technique}
    \begin{itemize}
      \item Abstraction des couches plus basses
      \item On peut tout programmer à son gré (tout est API!)
      \item Permet la mise en place d'architectures scalables (en théorie)
    \end{itemize}
  \end{frame}

  \subsection[PaaS]{PaaS : Platform as a Service}

  \begin{frame}
    \frametitle{PaaS : les principes}
    \begin{itemize}
      \item Fourniture d'une plateforme de développement
      \item Fourniture d'une plateforme de déploiement
      \item Pour un langage / un framework
      \item Principalement utilisé par des développeurs
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Exemples de PaaS publics}
    \begin{itemize}
      \item Amazon OpsWork / Elastic Beanstalk
      \item Google App Engine
      \item Heroku \pause
      \item OVH (Lamp Stack et Ruby Stack pour developpeurs)\\
      \url{http://www.ovh.com/fr/vps/systeme-exploitation.xml}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Solutions de PaaS privé}
    \begin{itemize}
      \item Cloud Foundry
      \item OpenShift (Red Hat)
      \item Solum
    \end{itemize}
  \end{frame}

  \subsection[IaaS]{IaaS : Infrastructure as a Service}

  \begin{frame}
    \frametitle{Amazon Web Services (AWS) et les autres}
    \begin{itemize}
      \item Service (cloud public) : \textcolor{blue}{AWS}
      \begin{itemize}
        \item Pionnier du genre (dès 2002)
        \item Elastic Compute Cloud (\textcolor{blue}{EC2})
        \item Elastic Block Storage (\textcolor{blue}{EBS})
        \item Simple Storage Service (\textcolor{blue}{S3})
      \end{itemize}
        \item Logiciels libres permettant le déploiement d'un cloud privé :
      \begin{itemize}
        \item Eucalyptus
        \item CloudStack
        \item OpenNebula
        \item \textbf{OpenStack}
      \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Les clouds publics concurrents d'AWS}
    \begin{itemize}
      \item Google Compute Engine
      \item Rackspace
      \item HP Cloud
      \item Microsoft Azure
      \item En France
      \begin{itemize}
        \item \textbf{Cloudwatt}
        \item \textbf{Numergy}
        \item \textbf{Outscale}
      \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Virtualisation dans le cloud}
    \begin{itemize}
      \item Le cloud IaaS repose souvent sur la virtualisation
      \item Ressources compute $\leftarrow$ virtualisation
      \item Virtualisation complète : KVM, Xen
      \item Virtualisation containers : OpenVZ, LXC, Docker
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Notions et vocabulaire IaaS}
    \begin{itemize}
      \item Images
      \item Instances
      \item Types d'instance (flavors)
      \item Volumes\pause
      \item Stockage block
      \item Stockage objet\pause
      \item IP flottantes/élastiques\pause
      \item Groupes de sécurité\pause
      \item Paires de clés\pause
      \item API REST\pause
      \item API de metadata et user data
      \item Cloud-init
      \note{{\tiny Image : Photo d'une machine virtuelle contenant les informations nécessaires pour lancer une instance. Contient généralement un OS et/ou des applications. C'est un genre de template.\\}}
      \note{{\tiny Instance : Une machine virtuelle lancée depuis une Image. On peut lancer plusieurs instances depuis la même image.\\}}
      \note{{\tiny Flavors : Type d'instance prédéfini, détermine par exemple CPU et RAM. Utile pour positionner l'instance au bon endroit dans le datacenter.\\}}
      \note{{\tiny Volumes : Disque dur associé à une instance.\\}}
      \note{{\tiny Stockage block : Type de stockage utilisé pour les volumes.\\}}
      \note{{\tiny Stockage objet : Type de stockage utilisé pour les images ou tout autre fichier.\\}}
      \note{{\tiny Floating IP : IP publique NATée attribuée à une machine\\}}
      \note{{\tiny Groupe de sécurité : Règles d'accès aux machines\\}}
      \note{{\tiny Paire de clés : clef SSH\\}}
      \note{{\tiny API REST : Interface de programmation de type Representational State Transfer. En gros, architecture de communication client-serveur, avec interfaces uniforme, gestion de ressources, \\}}
      \note{{\tiny API metadata et userdata : API permettant d'accèder à des données pour configurer et gérer une VM (ex : récuperer l'adresse d'ip de la machine\\}}
      \note{{\tiny Cloud-init : Ensemble d'outils permettant de faciliter l'initialisation de machines virtuelles dans un cloud\\}}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Notions et vocabulaire IaaS}
    \begin{itemize}
      \item L'instance est par définition éphémère
      \item Elle doit être utilisée comme ressource de calcul
      \item Une image se personnalise lors de son instanciation grâce à l'API de metadata
      \item Séparer les données des instances
      \item Choix du type de stockage : éphémère, volume, objet
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{À retenir}
    \Huge{Virtualisation $\ne$ IaaS}
  \end{frame}

  \begin{frame}
    \frametitle{AWS}
    \huge{Regardons l'interface web d'Amazon}
  \end{frame}

  \subsection[Stockage]{Stockage : block, objet, SDS}

  \begin{frame}
    \frametitle{Stockage block}
    \begin{itemize}
      \item Accès à des raw devices type \textit{/dev/vdb}
      \item Possibilité d'utiliser n'importe quel système de fichiers
      \item Compatible avec toutes les applications legacy
      \item Technos : iSCSI, Fiber Channel, FCoE
      \note{Samba, NFS, CIFS sont pas des block storage, mais des file storage}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Stockage objet}
    \begin{itemize}
      \item Pousser et retirer des objets dans un container/bucket
      \item Pas de hiérarchie des données, pas de système de fichiers
      \item Accès par les APIs
      \item L'application doit être conçue pour tirer partie du stockage objet
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Stockage objet : schéma}
    \begin{center}
      \includegraphics{images/stockage-objet.png}
    \end{center}
  \end{frame}

  \begin{frame}
    \frametitle{SDS : Software Defined Storage}
    \begin{itemize}
      \item Utilisation de commodity hardware
      \item Pas de RAID matériel
      \item Le logiciel est responsable de garantir les données
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Deux solutions : OpenStack Swift et Ceph}
    \begin{itemize}
      \item Swift fait partie du projet OpenStack et fournit du stockage objet
      \item Ceph fournit du stockage objet, block et FS
      \item Les deux sont du SDS
      \item Théorème CAP : on en choisit deux
    \end{itemize}
    \begin{description}[Partition Tolerance]
        \item[Consistancy] Tous les noeuds du système voient exactement les mêmes données au même moment
        \item[Availability] Toutes les requêtes doivent reçevoir une réponse
        \item[Partition Tolerance] En cas de morcellement en sous-réseaux, chacun doit pouvoir fonctionner de manière autonome
    \end{description}
  \end{frame}

  \begin{frame}
  \frametitle{Théorème CAP}
  \includegraphics[width=\textwidth,height=\textheight]{images/cap.jpg}
  \end{frame}

  \begin{frame}
  \frametitle{Swift}
    \begin{itemize}
      \item Swift est un projet OpenStack
      \item Le projet est né chez Rackspace avant la création d'OpenStack
      \item Swift est en production chez Rackspace depuis lors
      \item C'est le composant le plus mature d'OpenStack
      \item Théorème CAP : AP
    \end{itemize}
  \end{frame}

  \begin{frame}
  \frametitle{Ceph}
    \begin{itemize}
      \item Projet totalement parallèle à OpenStack
      \item Supporté par une entreprise (Inktank) récemment rachetée par Red Hat
      \item Fournit d'abord du stockage objet
      \item L'accès aux données se fait via RADOS : 
      \note{RADOS: reliable autonomic distributed object store\\}
      \begin{itemize}
        \item Accès direct depuis une application avec librados
        \item Accès via une API REST grâce à radosgw
      \end{itemize}
      \item La couche RBD permet d'accéder aux données en mode block (volumes)
      \note{RBD: RADOS Block Device\\}
      \item CephFS permet un accès par un système de fichiers POSIX
      \note{CephFS peut être monté par linux avec mount.ceph\\}
      \item Théorème CAP : CP
    \end{itemize}
  \end{frame}

  \subsection[Orchestration]{Orchestrer les ressources de son IaaS}

  \begin{frame}
    \frametitle{Pourquoi orchestrer}
    \begin{itemize}
      \item Définir tout une infrastructure dans un seul fichier texte
      \item Être en capacité d'instancier une infrastructure entière en un appel API
      \item Adapter ses ressources en fonction de ses besoins en temps réel (autoscaling)
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Exemples d'orchestration}
    \begin{itemize}
      \item Amazon CloudFormation
      \item OpenStack Heat
      \item Microsoft Azure Automation
    \end{itemize}
  \end{frame}
  
  \begin{frame}[containsverbatim]
    \frametitle{Exemples d'orchestration}
\begin{verbatim}
resources:
  my_instance:
    type: AWS::EC2::Instance
    properties:
      KeyName: { get_param: KeyName }
      ImageId: { get_param: ImageId }
      InstanceType: { get_param: InstanceType }
\end{verbatim}
  \end{frame}

  \subsection[APIs]{APIs : quel rôle ?}

  \begin{frame}
    \frametitle{API ?}
    \begin{itemize}
      \item \textit{Application Programming Interface}
      \item Au sens logiciel : Interface permettant à un logiciel d'utiliser une bibliothèque
      \item Au sens cloud : Interface permettant à un logiciel d'utiliser un service (XaaS)
      \item Il s'agit le plus souvent d'API HTTP REST
    \end{itemize}
  \end{frame}

  \begin{frame}[containsverbatim]
    \frametitle{Exemple concret}
\begin{verbatim}
GET /v2.0/networks/network_id
{
   "network":{
      "status":"ACTIVE",
      "subnets":[
         "54d6f61d-db07-451c-9ab3-b9609b6b6f0b"
      ],
      "name":"private-network",
      "provider:physical_network":null,
      "admin_state_up":true,
      "tenant_id":"4fd44f30292945e481c7b8a0c8908869",
      "provider:network_type":"local",
      "router:external":true,
      "shared":true,
      "id":"d32019d3-bc6e-4319-9c1d-6722fc136a22",
      "provider:segmentation_id":null
   }
}
\end{verbatim}
  \end{frame}

